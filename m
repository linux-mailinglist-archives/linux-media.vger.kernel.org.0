Return-Path: <linux-media-owner@vger.kernel.org>
X-Original-To: lists+linux-media@lfdr.de
Delivered-To: lists+linux-media@lfdr.de
Received: from vger.kernel.org (vger.kernel.org [209.132.180.67])
	by mail.lfdr.de (Postfix) with ESMTP id 96F6417D7C9
	for <lists+linux-media@lfdr.de>; Mon,  9 Mar 2020 02:31:09 +0100 (CET)
Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
        id S1726508AbgCIBbD (ORCPT <rfc822;lists+linux-media@lfdr.de>);
        Sun, 8 Mar 2020 21:31:03 -0400
Received: from relmlor2.renesas.com ([210.160.252.172]:24988 "EHLO
        relmlie6.idc.renesas.com" rhost-flags-OK-OK-OK-FAIL)
        by vger.kernel.org with ESMTP id S1726346AbgCIBbD (ORCPT
        <rfc822;linux-media@vger.kernel.org>);
        Sun, 8 Mar 2020 21:31:03 -0400
Date:   09 Mar 2020 10:31:01 +0900
X-IronPort-AV: E=Sophos;i="5.70,530,1574089200"; 
   d="scan'208";a="41113966"
Received: from unknown (HELO relmlir5.idc.renesas.com) ([10.200.68.151])
  by relmlie6.idc.renesas.com with ESMTP; 09 Mar 2020 10:31:01 +0900
Received: from mercury.renesas.com (unknown [10.166.252.133])
        by relmlir5.idc.renesas.com (Postfix) with ESMTP id 76F41400857C;
        Mon,  9 Mar 2020 10:31:01 +0900 (JST)
Message-ID: <87r1y2wbze.wl-kuninori.morimoto.gx@renesas.com>
From:   Kuninori Morimoto <kuninori.morimoto.gx@renesas.com>
To:     Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Cc:     Alex Riesen <alexander.riesen@cetitec.com>,
        Geert Uytterhoeven <geert@linux-m68k.org>,
        Kieran Bingham <kieran.bingham@ideasonboard.com>,
        Mauro Carvalho Chehab <mchehab@kernel.org>,
        Hans Verkuil <hverkuil-cisco@xs4all.nl>,
        Rob Herring <robh+dt@kernel.org>,
        Mark Rutland <mark.rutland@arm.com>,
        Driver Development <devel@driverdev.osuosl.org>,
        Linux Media <linux-media@vger.kernel.org>,
        Linux Kernel <linux-kernel@vger.kernel.org>,
        Device Tree <devicetree@vger.kernel.org>,
        Renesas SoC <linux-renesas-soc@vger.kernel.org>
Subject: Re: [PATCH 8/8] arm64: dts: renesas: salvator: add a connection from adv748x codec (HDMI input) to the R-Car SoC
In-Reply-To: <20200306134546.GE4878@pendragon.ideasonboard.com>
References: <CAMuHMdV9urx-6N4tiaPdkssa6Wu-9HSB4VY-rvCu+8JpfZcBfA@mail.gmail.com>
        <20200302134011.GA3717@pflmari>
        <CAMuHMdWobAE+y90DRi+zQadObWPxLyQiGNTe4t77O-2S1Vp5yA@mail.gmail.com>
        <20200302150706.GB3717@pflmari>
        <CAMuHMdW21rYXoOSE8azHNqYjng_j41rsL=Fo2bZc=1ULi9+pLw@mail.gmail.com>
        <20200302160906.GC3717@pflmari>
        <CAMuHMdVNGsVHyvAgC5dAHx=8Ax18EHx2tS6Hm5Bkg4ms=mW6Zw@mail.gmail.com>
        <20200305143628.GB25741@pflmari>
        <20200306131632.GA4878@pendragon.ideasonboard.com>
        <20200306134154.GD27714@pflmari>
        <20200306134546.GE4878@pendragon.ideasonboard.com>
User-Agent: Wanderlust/2.15.9 Emacs/25.2 Mule/6.0
MIME-Version: 1.0 (generated by SEMI-EPG 1.14.7 - "Harue")
Content-Type: text/plain; charset=US-ASCII
Sender: linux-media-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-media.vger.kernel.org>
X-Mailing-List: linux-media@vger.kernel.org


Hi

> > > Those clocks are part of the CSI-2 protocol and also don't need to be
> > > explicitly controlled. As far as I can tell from a quick check of the
> > > ADV7482 documentation, only the I2S MCLK is a general-purpose clock that
> > > needs to be exposed.
(snip)
> > Do you know, by chance, which of the snd_soc* callbacks should be used to
> > implement setting of the MCLK? The one in snd_soc_component_driver or
> > snd_soc_dai_driver->ops (snd_soc_dai_ops)?
> > 
> > Or how the userspace interface looks like? Or, if there is no userspace
> > interface for this, how the MCLK is supposed to be set? Through mclk-fs?
> 
> I'm afraid my knowledge of the sound subsystem is limited. Morimoto-san
> is the main developer and maintainer of Renesas sound drivers.
> Morimoto-sensei, would you have an answer to that question ? :-)

In my quick check, it goes to AUDIO_CLKC.
If so, you can update rcar_sound::clocks.

	&rcar_sound {
		...
-		/* update <audio_clk_b> to <cs2000> */
+		/* update <audio_clk_b> to <cs2000>,
+		 *        <audio_clk_c> to <adv748x> */
		clocks = <&cpg CPG_MOD 1005>,
			...
			 <&audio_clk_a>, <&cs2000>,
-			 <&audio_clk_c>,
+			 <&adv748x>,
			 <&cpg CPG_CORE CPG_AUDIO_CLK_I>;

Thank you for your help !!

Best regards
---
Kuninori Morimoto
