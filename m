Return-Path: <linux-media+bounces-1171-lists+linux-media=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-media@lfdr.de
Delivered-To: lists+linux-media@lfdr.de
Received: from sv.mirrors.kernel.org (sv.mirrors.kernel.org [IPv6:2604:1380:45e3:2400::1])
	by mail.lfdr.de (Postfix) with ESMTPS id 55FC37FAB09
	for <lists+linux-media@lfdr.de>; Mon, 27 Nov 2023 21:09:55 +0100 (CET)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by sv.mirrors.kernel.org (Postfix) with ESMTPS id 0FC96281A85
	for <lists+linux-media@lfdr.de>; Mon, 27 Nov 2023 20:09:54 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 6C68F45BF6;
	Mon, 27 Nov 2023 20:09:50 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=collabora.com header.i=@collabora.com header.b="QPZuk7c6"
X-Original-To: linux-media@vger.kernel.org
Received: from madras.collabora.co.uk (madras.collabora.co.uk [46.235.227.172])
	by lindbergh.monkeyblade.net (Postfix) with ESMTPS id 2A247D6D
	for <linux-media@vger.kernel.org>; Mon, 27 Nov 2023 12:09:45 -0800 (PST)
Received: from mz550.lan (ec2-34-240-57-77.eu-west-1.compute.amazonaws.com [34.240.57.77])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	 key-exchange X25519 server-signature RSA-PSS (4096 bits) server-digest SHA256)
	(No client certificate requested)
	(Authenticated sender: dbrouwer)
	by madras.collabora.co.uk (Postfix) with ESMTPSA id F3D5D66057B6;
	Mon, 27 Nov 2023 20:09:42 +0000 (GMT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=collabora.com;
	s=mail; t=1701115783;
	bh=iF3eFywIAnC+12FbjqxcMFOdIj1PcvgCzRIVmVnrfY0=;
	h=From:To:Cc:Subject:Date:From;
	b=QPZuk7c6YqIrJpj3OLwC44tSbltYM9n4VGxuKeJR79NhJrLUIkZ/cUsKxuKhqAsSv
	 G59s3MZU0WYAd+GgEMceFddYoJ4t+JB9coUZ7kj9J7GNxNyVyEYHh/Dti6mBjPEH5r
	 3/Z2rwHOxSCkEjItv0pA/dHOb7zbEIBbI9oPLsVEuCaM/hbPEjbp5X6arud3PTpV6H
	 bB/FlrQiOxLW3XhaO605w8XWw1ctbWNJ5nyGSJMr+KggxbU3jwwgZ97AV0bYR7ew/b
	 Plzkhu1SdjwwBmYVtlgZ26KLMQeJkRo8h4cA97KzUMXCsxGNK8Qbtf/0BZHHCQuYss
	 o/rr5j1kNPg0Q==
From: Deborah Brouwer <deborah.brouwer@collabora.com>
To: linux-media@vger.kernel.org
Cc: hverkuil-cisco@xs4all.nl,
	Deborah Brouwer <deborah.brouwer@collabora.com>
Subject: [PATCH 0/4] v4l2-tracer: track changes from syncing with kernel
Date: Mon, 27 Nov 2023 12:09:10 -0800
Message-ID: <cover.1701114910.git.deborah.brouwer@collabora.com>
X-Mailer: git-send-email 2.41.0
Precedence: bulk
X-Mailing-List: linux-media@vger.kernel.org
List-Id: <linux-media.vger.kernel.org>
List-Subscribe: <mailto:linux-media+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-media+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This patch series aims to solve the potential breakage of the v4l2-tracer
every time that v4l-utils is synced with the latest kernel headers.

Currently the v4l2-tracer autogeneration script is run by meson. If the script gets
confused by changes to the latest kernel headers, then the v4l2-tracer wonâ€™t compile.
And, even worse, the autogeneration script will have overwritten the autogenerated
files so there is no history of the changes that broke the compilation.

This series solves the problem by adding the autogenerated files to the git repository.
It stops using meson to create the files and instead, patches the v4l2-tracer whenever
v4l-utils is synced with the latest kernel headers. If compilation breaks, it is easy
to fix by just removing the v4l2-tracer patches before committing the other changes
related to the sync.

Deborah Brouwer (4):
  v4l2-tracer: autogenerate files that can be added to git
  v4l2-tracer: add auto-generated files to git repo
  v4l2-tracer: stop auto-generating files with meson
  sync-with-kernel.sh: create v4l2-tracer patches

 .gitignore                               |    1 +
 sync-with-kernel.sh                      |   25 +
 utils/v4l2-tracer/meson.build            |   55 +-
 utils/v4l2-tracer/retrace-gen.cpp        | 5664 ++++++++++++++++++++++
 utils/v4l2-tracer/retrace-gen.h          |  144 +
 utils/v4l2-tracer/trace-gen.cpp          | 3225 ++++++++++++
 utils/v4l2-tracer/trace-gen.h            |  144 +
 utils/v4l2-tracer/v4l2-tracer-gen.pl     |   12 +-
 utils/v4l2-tracer/v4l2-tracer-info-gen.h | 2419 +++++++++
 9 files changed, 11632 insertions(+), 57 deletions(-)
 create mode 100644 utils/v4l2-tracer/retrace-gen.cpp
 create mode 100644 utils/v4l2-tracer/retrace-gen.h
 create mode 100644 utils/v4l2-tracer/trace-gen.cpp
 create mode 100644 utils/v4l2-tracer/trace-gen.h
 create mode 100644 utils/v4l2-tracer/v4l2-tracer-info-gen.h

-- 
2.41.0


